<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Firm | Dezan Shira & Associates</title>
	<meta name="description" content="Dezan Shira & Associates is a foreign direct investment firm providing tax, legal and accounting services in China, Hong Kong, India, Vietnam, Singapore and ASEAN." />
    <meta property="og:title" content="Our Firm | Dezan Shira & Associates"/>
    <meta property="og:description" content="Dezan Shira & Associates is a foreign direct investment firm providing tax, legal and accounting services in China, Hong Kong, India, Vietnam, Singapore and ASEAN."/>
    <link rel="preload" as="image" href="/img/about-us/HistoryMilestones.webp" type="image/webp" fetchpriority="high">
    <link rel="stylesheet" href="../css/main.min.css" type="text/css" />
    <link rel="stylesheet" href="../css/vendor/splide.min.css" type="text/css">
 <style>
    header,.masthead,footer{z-index: 1;}
    /* Year Navigation */
    .year-nav {
        z-index: 1 !important;
        position: sticky;
        top: 85px;
        z-index: 100;
        background: #ffffff;
        border-bottom: 1px solid #f5f5f5;
        border-top: 1px solid #f5f5f5;
        padding: 16px 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .year-nav__container {
        max-width: 1280px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 0 16px;
        justify-content: center;
    }

    .year-nav__arrow {
        background: #ffffff;
        /* border: 1px solid #e0e0e0; */
        border-radius: 9999px;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 150ms cubic-bezier(0.16, 1, 0.3, 1);
        color: #666666;
    }

    .year-nav__arrow:hover:not(:disabled) {
        /* background: #207fd4; */
        color: #207fd4;
        /* border-color: #207fd4; */
    }

    .year-nav__arrow:disabled {
        opacity: 0.3;
        cursor: not-allowed;
    }

    .year-nav__scroll {
        flex: 1;
        overflow: hidden;
        position: relative;
    }


    .year-nav__button--active {
        color: #207fd4;
        border-color:#207fd4 !important;
    }

    /* Vertical Progress Bar */
    .timeline-progress {
        position: fixed;
        right: 30px;
        top: 50%;
        transform: translateY(-50%);
        height: 300px;
        z-index: 0;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .timeline-progress__track-wrapper {
        position: relative;
        height: 100%;
        padding: 0 12px; /* Increase hover area */
        cursor: pointer;
    }

    .timeline-progress__track {
        width: 4px;
        height: 100%;
        background: rgba(32, 127, 212, 0.1);
        border-radius: 2px;
        position: relative;
        pointer-events: none;
        transition: width 150ms ease;
    }

    .timeline-progress__track-wrapper:hover .timeline-progress__track {
        width: 6px;
    }

    .timeline-progress__fill {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        background: #207fd4;
        border-radius: 2px;
        transition: height 150ms ease-out;
        pointer-events: none;
    }

    .timeline-progress__handle {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        width: 16px;
        height: 16px;
        background: #ffffff;
        border: 3px solid #207fd4;
        border-radius: 50%;
        cursor: pointer;
        transition: transform 150ms ease-out;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        pointer-events: none;
    }

    .timeline-progress__year {
        position: absolute;
        left: -50px;
        background: rgba(255, 255, 255, 0.9);
        padding: 4px 8px;
        border-radius: 4px;
        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(32, 127, 212, 0.15);
        min-width: 40px;
        text-align: center;
        opacity: 0;
        transition: opacity 150ms ease;
        pointer-events: none;
    }

    .timeline-progress__year.visible {
        opacity: 1;
    }

    .timeline-progress__year-label {
        display: none; /* Hide the label for more subtle appearance */
    }

    .timeline-progress__year-value {
        font-size: 14px;
        font-weight: 500;
        color: #207fd4;
    }

    /* Timeline Container */
    .timeline-container {
        max-width: 1024px;
        margin: 0 auto;
        padding: 32px 16px;
    }

    .timeline {
        position: relative;
    }

    .timeline__line {
        position: absolute;
        left: 50%;
        top: 0;
        bottom: 0;
        width: 2px;
        background: #207fd4;
        transform: translateX(-50%);
    }

    .timeline__content {
        position: relative;
    }

    .timeline__item {
        position: relative;
        margin-bottom: 32px;
        opacity: 0;
        transform: translateY(30px);
        transition: all 250ms cubic-bezier(0.16, 1, 0.3, 1);
    }

    .timeline__item.animate-in {
        opacity: 1;
        transform: translateY(0);
    }

    .timeline__item .timeline__content-wrapper.zoom-animate {
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        transform: scale(1.05);
        z-index: 2;
    }


    /* Alternating layout */
    .timeline__item:nth-child(odd) {
        padding-right: calc(50% + 40px);
    }

    .timeline__item:nth-child(even) {
        padding-left: calc(50% + 40px);
    }

    /* Timeline dots */
    .timeline__item::before {
        content: '';
        position: absolute;
        top: 20px;
        width: 16px;
        height: 16px;
        background: #ffffff;
        border: 3px solid #207fd4;
        border-radius: 50%;
        z-index: 2;
    }

    .timeline__item:nth-child(odd)::before {
        right: calc(50% - 8px);
    }

    .timeline__item:nth-child(even)::before {
        left: calc(50% - 8px);
    }

    /* Content Layout */
    .timeline__content-wrapper {
        display: flex;
        flex-direction: column;
        gap: 16px;
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
    }

    .timeline__image-container {
        position: relative;
        width: 150px;
        height: 100px;
        border-radius: 8px;
        overflow: hidden;
        background: #f0f0f0;
        flex-shrink: 0;
        box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px;
    }

    .timeline__image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: opacity 250ms cubic-bezier(0.16, 1, 0.3, 1);
        opacity: 0;
    }

    .timeline__image.loaded {
        opacity: 1;
    }

    .timeline__image-fallback {
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #207fd4, #1a6bb5);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 550;
        font-size: 12px;
    }

    .timeline__year {
        color: #207fd4;
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .timeline__title {}

    .timeline__description {
        color: #666666;
    }

    /* Loading Skeleton */
    .loading-skeleton {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: #f0f0f0;
        overflow: hidden;
    }

    .loading-skeleton__shimmer {
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(32, 127, 212, 0.1), transparent);
        animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
        to {
            left: 100%;
        }
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .timeline__line {
            left: 20px;
        }

        .timeline__item {
            padding-left: 60px;
            padding-right: 0;
            margin-bottom: 60px;
        }

        .timeline__item:nth-child(odd),
        .timeline__item:nth-child(even) {
            padding-left: 60px;
            padding-right: 0;
        }

        .timeline__item::before {
            left: 12px;
            right: auto;
        }

        .timeline__item:nth-child(odd)::before,
        .timeline__item:nth-child(even)::before {
            left: 12px;
            right: auto;
        }

        .year-nav__container {
            padding: 0 12px;
            gap: 12px;
        }

        .year-nav__arrow {
            width: 36px;
            height: 36px;
        }

        .timeline-container {
            padding: 24px 12px;
        }

        .timeline__title {
            font-size: 20px;
        }

        .timeline__year {
            font-size: 18px;
        }

        .timeline-progress {
            right: 15px;
            height: 200px;
        }

        .timeline-progress__year {
            padding: 6px 10px;
        }

        .timeline-progress__year-value {
            font-size: 16px;
        }
    }

    @media (max-width: 480px) {
        .year-nav__button {
            padding: 6px 12px;
            font-size: 12px;
            min-width: 70px;
        }

        .timeline__title {
            font-size: 18px;
        }

        .timeline__description {
            font-size: 14px;
        }

        .timeline-progress {
            display: none; /* Hide on very small screens */
        }
    }
</style>
</head>

<body>
    <main class="home country-section" id="wrapper">
    @@include("../includes/header.html")
      <section class="masthead">
        <div class="section-wrapper-min">
          <div class="masthead__text justify-content-center">
            <h1>Asian Alliance
</h1>
          </div>
            <!-- <div class="breadcrumb justify-content-end">
              <ul>
                  <li><a href="/">Home</a></li>
                  <li class="active-item">About Us</li>
              </ul>
          </div> -->
        </div>
        <div class="masthead__bg"><img alt="Environment and Cleantech" src="/img/about-us/HistoryMilestones.webp"  width="1440" height="419"></div>
      </section>

<!-- Sticky Year Navigation -->
<nav class="year-nav" id="yearNav">
    <div class="year-nav__container filter-form">
        <div class="year-nav__scroll" id="yearNavScroll">
            <div class="filter-buttons year-nav__buttons" id="yearButtons">
                <!-- Decade buttons will be dynamically generated -->
            </div>
        </div>
    </div>
</nav>

<!-- Vertical Progress Bar -->
<div class="timeline-progress" id="timelineProgress">
    <div class="timeline-progress__track-wrapper" id="progressTrackWrapper">
        <div class="timeline-progress__track" id="progressTrack">
            <div class="timeline-progress__fill" id="progressFill"></div>
            <div class="timeline-progress__handle" id="progressHandle"></div>
        </div>
    </div>
    <div class="timeline-progress__year" id="progressYear">
        <div class="timeline-progress__year-label">Year</div>
        <div class="timeline-progress__year-value" id="progressYearValue">2024</div>
    </div>
</div>

<!-- Main Timeline Container -->
<main class="timeline-container">
    <div class="timeline">
        <div class="timeline__line"></div>
        <div class="timeline__content" id="timelineContent">
            <!-- Timeline items will be dynamically generated -->
        </div>
    </div>
</main>


</main>
    @@include("../includes/footer.html")
<script>
    // Timeline data
    const timelineData = [
        {
            year: 2024,
            title: "New Office Opening in Mongolia",
            description: "Dezan Shira & Associates expands its reach into Mongolia, establishing a new office to cater to growing client demand for market entry and business support services in the region.",
            image: "/img/about-us/2024-Mongolia-office.webp"
        },
        {
            year: 2023,
            title: "Expansion and new office opening in Dubai",
            description: "Dezan Shira & Associates strategically expands its operations to Dubai, setting up an office to leverage the city's position as a hub for trade and investment between the Middle East, Asia, and the rest of the world.",
            image: "/img/about-us/Dubai%20Office%20opening.webp",
        },
        {
            year: 2023,
            title: "Launch of Doing Business portals",
            description: "The firm introduces Doing Business portals, offering streamlined access to critical market intelligence and regulatory guidance for businesses looking to navigate the complexities of China, Hong Kong, Indonesia, India, Singapore and Vietnam markets.",
            image: "https://www.dezshira.com/userfiles/resources/history/Portal%20logos.gif"
        },
        {
            year: 2022,
            title: "Celebrating 30 years",
            description: "Dezan Shira & Associates celebrated three decades of excellence in providing comprehensive business advisory services across Asia.",
            image: "https://www.dezshira.com/userfiles/resources/history/Dezan-Shira-30th.jpg"
        },
        {
            year: 2022,
            title: "Launch of Middle East Briefing",
            description: "The firm launches Middle East Briefing, a new publication, providing key insights into trade and investment opportunities in the Middle East region.",
            image: "https://www.dezshira.com/userfiles/resources/history/Middle-East-Briefing.jpg"
        },
        {
            year: 2021,
            title: "New office Opening in Munich, Germany",
            description: "Setting up a legal entity in the heart of Europe, Dezan Shira & Associates opens a new office in Munich, Germany, to be closer to European investors who are looking to expand into Asia.",
            image: "https://www.dezshira.com/userfiles/resources/history/Germany%20office%20opening.jpg"
        },
        {
            year: 2020,
            title: "Asian Alliance expands into Bangladesh",
            description: "Dezan Shira & Associates welcomes <a href=\"https://www.dezshira.com/office/bangladesh\">A. Wahab & Co.</a> as a new member of the Dezan Shira Asian Alliance, based in Dhaka. <a href=\"https://www.dezshira.com/office/bangladesh\">Bangladesh</a> is becoming an important manufacturing centre in the region attracting players across a variety of sectors, well beyond traditional industries like textiles and garments.",
            image: "https://www.asiabriefing.com/mockups/dsa-mockup/history-milestones/assets/historyMilestones/bangladesh.jpg"
        },
        {
            year: 2020,
            title: "New US office launched",
            description: "Dezan Shira & Associates Launches its new Subsidiary for the <a href=\"http://dezshira.com/office/usa\">United States</a> and Canada Market.",
            image: "https://www.asiabriefing.com/mockups/dsa-mockup/history-milestones/assets/historyMilestones/us.jpg"
        },
        {
            year: 2020,
            title: "New office opening in Danang – 3rd in Vietnam",
            description: "Dezan Shira & Associates opens its 3rd Vietnam office located in beautiful <a href=\"https://www.dezshira.com/office/vietnam/da-nang.html\">Danang</a>. Danang is a key port city located in central Vietnam, a flourishing IT and software hub and a growing manufacturing destination. Our Danang office will support our many clients expanding throughout the Vietnam market.",
            image: "https://www.asiabriefing.com/mockups/dsa-mockup/history-milestones/assets/historyMilestones/Danang-vietnam.jpg"
        },
        {
            year: 2019,
            title: "New office opening in Indonesia",
            description: "Dezan Shira & Associates has opened its second office in Indonesia, located in <a href=\"https://www.dezshira.com/office/indonesia/batam.html\">Batam</a>. Batam is a tourism, industrial, outsourcing and transportation hub located only 20 km from Singapore. The city will host our back-office and business processing centre to serve our clients' rapid growth throughout the ASEAN region.",
            image: "https://www.asiabriefing.com/mockups/dsa-mockup/history-milestones/assets/historyMilestones/Indonesia.jpg"
        },
        {
            year: 2018,
            title: "Indonesia presence established",
            description: "Dezan Shira & Associates sets up in Indonesia following years of foreign direct investment work in the region.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2018-Indonesia.jpg"
        },
        {
            year: 2018,
            title: "Asiapedia launched",
            description: "Dezan Shira & Associates redesigned its knowledge sharing platform for businesspeople in Asia",
            image: "https://www.dezshira.com/themes/dsa/images/history/2018%20Asiapeida%20launched.jpg"
        },
        {
            year: 2017,
            title: "25th Anniversary Celebrations",
            description: "On November 10 2017, Dezan Shira & Associates hosted a gala dinner in Shanghai to celebrate the firm's 25th anniversary of doing business in Asia. More than 150 clients, partners, employees, and alumni joined this celebration event, sharing their story with Dezan Shira & Associates.",
            image: "https://www.dezshira.com/themes/dsa/images/history/25th-Anniversary-Celebrations.JPG"
        },
        {
            year: 2016,
            title: "HR and Payroll team creates ERP service",
            description: "IT, HR, and accounting expertise integrated into one dynamic ERP solution developed by our in-house team.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2016%20ERP.jpg"
        },
        {
            year: 2015,
            title: "Office opened in Dongguan",
            description: "Dezan Shira &amp; Associates opens an office in <ahref='https://www.dezshira.com/office/china/dongguan.html'><strong>Dongguan</strong></a>.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2015-dongguan-office.jpg"
        },
        {
            year: 2014,
            title: "Dezan Shira Asian Alliance",
            description: "Seeking to provide legal, tax and audit advisory services in multiple Asian jurisdictions, Dezan Shira creates the <a href=\"https://www.dezshira.com/about-us/asian-alliance.html\">Dezan Shira Asian Alliance</a> with selected local practices in <a href=\"https://www.dezshira.com/office/thailand.html\">Thailand</a>, <a href=\"https://www.dezshira.com/office/malaysia.html\">Malaysia</a>, <a href=\"https://www.dezshira.com/office/indonesia\">Indonesia</a> and the <a href=\"https://www.dezshira.com/office/philippines.html\">Philippines</a>.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2014-Asian%20Alliance.jpg"
        },
        {
            year: 2014,
            title: "Vietnam Briefing",
            description: "In 2014, just as Vietnam was currently undergoing dynamic changes in its economy and culture, we felt it was time to create a logo that more accurately represented this exciting country",
            image: "https://www.dezshira.com/themes/dsa/images/history/2014-Vietnam%20Briefing.jpg"
        },
        {
            year: 2013,
            title: "Dezan Shira's expansion as an Asia-focused practice",
            description: "As foreign direct investment flows increase throughout Southeast Asia due to the growing regional clout of the 10-nation ASEAN bloc, the practice rolls out a newly reinvigorated Asia Briefing portal. In line with Dezan Shira & Associates' Asia-focused approach, <a href=\"http://www.aseanbriefing.com\">ASEAN Briefing</a> is also launched, which contains details of free trade and double tax agreements throughout Asia, including those between ASEAN, China and India.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2013-ASEAN%20Briefing.jpg"
        },
        {
            year: 2012,
            title: "Special liaison office opens in the United States.",
            description: "In the <a href=\"https://www.dezshira.com/office/usa\">United States</a>, Dezan Shira & Associates establishes a client liaison office in Charlotte, North Carolina.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2012-DSA%2020th%20anniversary(1).jpg"
        },
        {
            year: 2012,
            title: "Dezan Shira & Associates is recognized for its innovative Asia Briefing publishing house.",
            description: "The firm wins one of the Leading Edge Alliance highest accolades: Most Innovative Firm of the Year. The practice also celebrates its 20th anniversary by releasing a specially commissioned piece of classical music, with live premieres taking place at celebratory events in Beijing, Shanghai and Guangzhou.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2012-DSA%2020th%20anniversary(2).jpg"
        },
        {
            year: 2011,
            title: "Tianjin and Suzhou Offices Open, International",
            description: "The practice continues its China expansion. With Tianjin developing as a manufacturing center for Beijing, and Suzhou becoming a credible alternative for manufacturing in Shanghai, the practice opens new offices in these cities.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2011-Singapore%20office.jpg"
        },
        {
            year: 2011,
            title: "Expansion continues with office openings in Singapore and in Ho Chi Minh City, Vietnam.",
            description: "Dezan Shira & Associates expands into South Vietnam with the opening of an office in <a href=\"https://www.dezshira.com/office/vietnam/ho-chi-minh-city.html\">Ho Chi Minh City</a>, Vietnam's largest commercial port. An office is established in <a href=\"https://www.dezshira.com/office/singapore.html\">Singapore</a> as the practice eyes development in ASEAN and Southeast Asia as key to its strategic regional development as an Asia-focused firm.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2011-Vietnam%20office.jpg"
        },
        {
            year: 2010,
            title: "Qingdao office opens.",
            description: "China expansion continues with the establishment of an office in <a href=\"https://www.dezshira.com/office/china/qingdao.html\"><strong>Qingdao</strong></a>.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2010-Qingdao%20office.jpg"
        },
        {
            year: 2008,
            title: "Expansion into Vietnam",
            description: "Dezan Shira & Associates expands into Vietnam by opening an office in <a href=\"https://www.dezshira.com/office/vietnam/hanoi.html\">Hanoi</a>, and launches <a href=\"http://www.vietnam-briefing.com/\">Vietnam Briefing</a>.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2008-Vietnam-office.jpg"
        },
        {
            year: 2008,
            title: "Dezan Shira opens office in New Delhi, India.",
            description: "The practice opens a new office in <a href=\"https://www.dezshira.com/office/india/delhi.html\"><strong>Delhi</strong></a>, India.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2008-India%20office.jpg"
        },
        {
            year: 2007,
            title: "Hangzhou office opens.",
            description: "China expansion continues with the opening of an office in Hangzhou in the Yangtze River Delta region.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2007-Hangzhou%20office.jpg"
        },
        {
            year: 2007,
            title: "Italian liaison office opens in Treviso.",
            description: "International development arises with the opening of a liaison office in Italy to better service the firm's growing Italian client base.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2007-Italy%20liaison%20office.jpg"
        },
        {
            year: 2007,
            title: "Expansion into India",
            description: "The practice expands into India by setting up operations in <a href=\"https://www.dezshira.com/office/india/mumbai.html\">Mumbai</a> and New Delhi.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2007-India%20office.jpg"
        },
        {
            year: 2007,
            title: "Launch of India Briefing",
            description: "Launch <a href=\"http://www.india-briefing.com/\" target=\"_blank\"><strong>India Briefing</strong></a> to support the marketing of the India practice",
            image: "https://www.dezshira.com/themes/dsa/images/history/2007-India%20Briefing.jpg"
        },
        {
            year: 2006,
            title: "Opening of Dezan Shira offices in Zhongshan and Ningbo",
            description: "Further South China expansion is realized through the opening of an office in <a href=\"https://www.dezshira.com/office/china/zhongshan.html\">Zhongshan</a>, serving the development of the West Pearl River Delta region. Additionally, as <a href=\"https://www.dezshira.com/office/china/ningbo.html\">Ningbo's</a> deep water port facilities are developed, and improved road, rail and air connections with Shanghai are built-up, the practice opens an office in the city.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2006-Zhongshan%20Ningbo%20offices.jpg"
        },
        {
            year: 2005,
            title: "Guangzhou office opens",
            description: "The practice embarks on a specific campaign to establish offices throughout China. An immediate result of this is the establishment of an office in downtown <a href=\"https://www.dezshira.com/office/china/guangzhou.html\">Guangzhou</a>.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2005-Guangzhou%20offices.jpg"
        },
        {
            year: 2005,
            title: "Dezan Shira & Associates joins Leading Edge Alliance of Global Auditors.",
            description: "The firm is invited to join the <a href=\"http://www.leadingedgealliance.com/\">Leading Edge Alliance</a>, a significant global network of international accountants and auditors, with a combined annual turnover of US$2.3 billion among its members.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2005-LEA.jpg"
        },
        {
            year: 2004,
            title: "Opening of Dezan Shira's Dalian office",
            description: "Dezan Shira &amp; Associates opens its office in <a href=\"https://www.dezshira.com/office/china/dalian.html\"><strong>Dalian</strong></a>.",
            image: "https://www.dezshira.com/themes/dsa/images/history/2004-Dalian%20offices.jpg"
        },
        {
            year: 1999,
            title: "First issue of China Briefing Magazine published.",
            description: "To better promote the firm and to bring all marketing needs directly under its own control, Dezan Shira & Associates launches its first magazine: <a href=\"http://www.china-briefing.com\">China Briefing</a>. The issue is distributed throughout five-star hotels in Shenzhen and Guangzhou and immediately runs out of the 1,000 copies printed. Over the next decade, distribution becomes national with circulation reaching 25,000 copies a month.",
            image: "https://www.dezshira.com/themes/dsa/images/history/1999-China%20Briefing.jpg"
        },
        {
            year: 1994,
            title: "Beijing and Shanghai offices open.",
            description: "The firm changes its name to Dezan Shira & Associates, moves its Shekou office to downtown Shenzhen, and opens additional offices in Beijing at the Lufthansa Center and in Shanghai in the Sen Mao Tower.",
            image: "https://www.dezshira.com/themes/dsa/images/history/1994-Beijing%20Shanghai%20offices.jpg"
        },
        {
            year: 1993,
            title: "Dezan Shira acquires its first clients.",
            description: "The firm services its first clients, which involved various China trademark applications, representative office establishments and joint venture contractual reviews, mainly within the offshore oil industry. The practice hires its first Chinese staff.",
            image: "https://www.dezshira.com/themes/dsa/images/history/1993-Dezan%20Shira%20acquires%20its%20first%20clients..jpg"
        },
        {
            year: 1992,
            title: "Founding of Dezan Shira & Associates",
            description: "Dezan Shira Business Management Services (China) Ltd. is formed in <a href=\"https://www.dezshira.com/office/hong-kong.html\">Hong Kong</a> with a remit to provide business advisory services to foreign investors in mainland China, including both post and pre-incorporation assistance, trademark registration, and related advice. The new company also opens a small office in Shekou, the deep water port of <a href=\"https://www.dezshira.com/office/china/shenzhen.html\">Shenzhen</a>, which has become a focal point for foreign investment due to its special status as China's first \"Special Economic Zone.\"",
            image: "https://www.dezshira.com/themes/dsa/images/history/1992-Founding%20of%20Dezan%20Shira%20&%20Associates.jpg"
        }
    ];
    
    // Global variables
    let currentActiveDecade = null;
    let currentActiveYear = null;
    let yearNavScrollPosition = 0;
    let isNavigating = false;
    let imageObserver = null;
    let activeYearObserver = null;
    let loadedImages = new Set();

    // DOM elements
    const yearButtons = document.getElementById('yearButtons');
    const yearNavScroll = document.getElementById('yearNavScroll');
    // const scrollLeftBtn = document.getElementById('scrollLeft');
    // const scrollRightBtn = document.getElementById('scrollRight');
    const timelineContent = document.getElementById('timelineContent');
    const progressTrackWrapper = document.getElementById('progressTrackWrapper');
    const progressTrack = document.getElementById('progressTrack');
    const progressFill = document.getElementById('progressFill');
    const progressHandle = document.getElementById('progressHandle');
    const progressYear = document.getElementById('progressYear');
    const progressYearValue = document.getElementById('progressYearValue');

    // Initialize the application
    document.addEventListener('DOMContentLoaded', function () {
        generateDecadeNavigation();
        generateTimelineItems();
        setupLazyLoading();
        // setupDecadeNavigation();
        setupScrollHandlers();
        setupProgressBar();
        updateActiveYear();
        animateTimelineItems();
    });

    // Helper function to get decade from year
    function getDecade(year) {
        return Math.floor(year / 10) * 10;
    }

    // Helper function to get decade label
    function getDecadeLabel(decade) {
        return `${decade}s`;
    }

    // Generate decade navigation buttons
    function generateDecadeNavigation() {
        const years = timelineData.map(item => item.year);
        const decades = [...new Set(years.map(year => getDecade(year)))].sort((a, b) => b - a); // Sort descending (latest first)

        decades.forEach(decade => {
            const button = document.createElement('button');
            button.className = 'year-nav__button filter-tab';
            button.textContent = getDecadeLabel(decade);
            button.setAttribute('data-decade', decade);

            // Add event listener for click
            button.addEventListener('click', (e) => {
                e.preventDefault();
                scrollToDecade(decade);
            });

            yearButtons.appendChild(button);
        });

        updateArrowStates();
    }

    // Generate timeline items
    function generateTimelineItems() {
        timelineData.forEach((item, index) => {
            const timelineItem = document.createElement('div');
            timelineItem.className = 'timeline__item';
            timelineItem.setAttribute('data-year', item.year);
            timelineItem.setAttribute('data-decade', getDecade(item.year));
            timelineItem.id = `timeline-${item.year}-${index}`;

            timelineItem.innerHTML = `
            <div class="timeline__content-wrapper">
                <div class="timeline__image-container" data-src="${item.image}" data-loaded="false">
                    <div class="loading-skeleton">
                        <div class="loading-skeleton__shimmer"></div>
                    </div>
                </div>
                <div class="timeline__year">${item.year}</div>
                <h5 class="timeline__title mb-0">${item.title}</h5>
                <p class="timeline__description">${item.description}</p>
            </div>
        `;

            timelineContent.appendChild(timelineItem);
        });
    }

    // Setup progress bar functionality
    function setupProgressBar() {
        // Handle click on track wrapper (increased hover area)
        progressTrackWrapper.addEventListener('click', (e) => {
            const rect = progressTrackWrapper.getBoundingClientRect();
            const clickY = e.clientY - rect.top;
            const percentage = Math.max(0, Math.min(1, clickY / rect.height));
            scrollToProgress(percentage);
        });

        // Handle hover to show year preview
        progressTrackWrapper.addEventListener('mousemove', (e) => {
            const rect = progressTrackWrapper.getBoundingClientRect();
            const hoverY = e.clientY - rect.top;
            const percentage = Math.max(0, Math.min(1, hoverY / rect.height));
            
            // Calculate which year this position represents
            const timelineItems = document.querySelectorAll('.timeline__item');
            const itemIndex = Math.floor(percentage * (timelineItems.length - 1));
            const item = timelineItems[Math.min(itemIndex, timelineItems.length - 1)];
            
            if (item) {
                const year = item.getAttribute('data-year');
                progressYearValue.textContent = year;
                progressYear.style.top = `${hoverY - 10}px`;
                progressYear.classList.add('visible');
            }
        });

        // Hide year preview when mouse leaves
        progressTrackWrapper.addEventListener('mouseleave', () => {
            progressYear.classList.remove('visible');
            progressYear.style.top = '';
            // Reset to current year
            if (currentActiveYear) {
                progressYearValue.textContent = currentActiveYear;
            }
        });
    }

    function scrollToProgress(progress) {
        const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
        const targetScroll = documentHeight * progress;
        
        window.scrollTo({
            top: targetScroll,
            behavior: 'smooth'
        });
    }

    function updateProgressBar(progress) {
        const percentage = progress * 100;
        progressFill.style.height = `${percentage}%`;
        progressHandle.style.top = `${percentage}%`;
        
        // Update year display based on progress
        const timelineItems = document.querySelectorAll('.timeline__item');
        const itemIndex = Math.floor(progress * (timelineItems.length - 1));
        const item = timelineItems[Math.min(itemIndex, timelineItems.length - 1)];
        
        if (item) {
            const year = item.getAttribute('data-year');
            progressYearValue.textContent = year;
        }
    }

    // Setup lazy loading with proper disconnect handling
    function setupLazyLoading() {
        // Disconnect existing observer if it exists
        if (imageObserver) {
            imageObserver.disconnect();
        }

        imageObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const container = entry.target;
                    const imageSrc = container.getAttribute('data-src');
                    const isLoaded = container.getAttribute('data-loaded') === 'true';

                    // Only load if not already loaded
                    if (!isLoaded && !loadedImages.has(imageSrc)) {
                        loadedImages.add(imageSrc);
                        container.setAttribute('data-loaded', 'true');
                        loadImage(container);
                    }

                    // Always unobserve after processing
                    imageObserver.unobserve(container);
                }
            });
        }, {
            root: null,
            rootMargin: '100px',
            threshold: 0
        });

        // Observe all image containers that haven't been loaded
        const imageContainers = document.querySelectorAll('.timeline__image-container[data-loaded="false"]');
        imageContainers.forEach(container => {
            imageObserver.observe(container);
        });
    }

    // Load image with proper error handling and no loops
    function loadImage(container) {
        if (!container) {
            console.warn("No container provided to loadImage.");
            return;
        }
        const imageSrc = container.getAttribute('data-src');
        if (!imageSrc) {
            console.warn("No data-src found on container:", container);
            handleImageError(container);
            return;
        }

        // Check if already loaded
        if (container.querySelector('.timeline__image') || container.querySelector('.timeline__image-fallback')) {
            return;
        }

        const img = document.createElement('img');
        img.className = 'timeline__image';
        img.alt = 'Timeline image';

        let imageLoaded = false;
        const loadTimeout = setTimeout(() => {
            if (!imageLoaded) {
                handleImageError(container);
            }
        }, 8000); // 8 second timeout

        img.onload = function () {
            if (imageLoaded) return; // Prevent double execution
            imageLoaded = true;
            clearTimeout(loadTimeout);

            // Remove loading skeleton
            const skeleton = container.querySelector('.loading-skeleton');
            if (skeleton) {
                skeleton.remove();
            }

            // Add image and fade in
            container.appendChild(img);
            setTimeout(() => {
                img.classList.add('loaded');
            }, 50);
        };

        img.onerror = function () {
            console.log("Image load error for", imageSrc);
            if (imageLoaded) return; // Prevent double execution
            imageLoaded = true;
            clearTimeout(loadTimeout);
            handleImageError(container);
        };

        // Start loading the image
        img.src = imageSrc;
    }

    // Handle image loading errors
    function handleImageError(container) {
        // Check if already handled
        if (container.querySelector('.timeline__image-fallback')) {
            return;
        }

        // Remove loading skeleton
        const skeleton = container.querySelector('.loading-skeleton');
        if (skeleton) {
            skeleton.remove();
        }

        // Create a fallback div
        const fallbackDiv = document.createElement('div');
        fallbackDiv.className = 'timeline__image-fallback';

        // Extract year for fallback text
        const yearElement = container.parentNode.querySelector('.timeline__year');
        const year = yearElement ? yearElement.textContent : 'Image';

        fallbackDiv.textContent = year;
        container.appendChild(fallbackDiv);
    }

    // Setup decade navigation functionality
    // function setupDecadeNavigation() {
    //     scrollLeftBtn.addEventListener('click', () => {
    //         const scrollAmount = 240; // Scroll 2-3 decades at once
    //         yearNavScrollPosition = Math.max(0, yearNavScrollPosition - scrollAmount);
    //         updateYearNavScroll();
    //     });

    //     scrollRightBtn.addEventListener('click', () => {
    //         const scrollAmount = 240; // Scroll 2-3 decades at once
    //         const maxScroll = Math.max(0, yearButtons.scrollWidth - yearNavScroll.clientWidth);
    //         yearNavScrollPosition = Math.min(maxScroll, yearNavScrollPosition + scrollAmount);
    //         updateYearNavScroll();
    //     });
    // }

    // Update year navigation scroll position
    function updateYearNavScroll() {
        yearButtons.style.transform = `translateX(-${yearNavScrollPosition}px)`;
        updateArrowStates();
    }

    // Update arrow button states
    function updateArrowStates() {
        const maxScroll = Math.max(0, yearButtons.scrollWidth - yearNavScroll.clientWidth);

        // scrollLeftBtn.disabled = yearNavScrollPosition <= 0;
        // scrollRightBtn.disabled = yearNavScrollPosition >= maxScroll || maxScroll === 0;
    }

    // Scroll to specific decade
    function scrollToDecade(decade) {
        isNavigating = true;

        // Find all timeline items in this decade and get the first one
        const decadeItems = document.querySelectorAll(`.timeline__item[data-decade="${decade}"]`);
        const targetElement = decadeItems[0]; // Get the first item in the decade

        if (targetElement) {
            // Calculate position to center the item in viewport
            const viewportHeight = window.innerHeight;
            const itemHeight = targetElement.offsetHeight;
            const itemTop = targetElement.offsetTop;
            const targetOffset = itemTop - (viewportHeight / 2) + (itemHeight * 1.5);

            window.scrollTo({
                top: Math.max(0, targetOffset),
                behavior: 'smooth'
            });

            // Update active decade immediately
            updateActiveDecadeButton(decade);
            currentActiveDecade = decade;

            // Reset navigation flag after scroll completes
            setTimeout(() => {
                isNavigating = false;
            }, 1000);
        }
    }

    // Setup scroll handlers for active year detection
    function setupScrollHandlers() {
        let scrollTimeout;

        window.addEventListener('scroll', () => {
            // Update progress bar
            const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollProgress = window.pageYOffset / documentHeight;
            updateProgressBar(scrollProgress);
            
            if (!isNavigating) {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    updateActiveYear();
                }, 150);
            }
        });
    }

    // Update active year based on scroll position
    function updateActiveYear() {
        const viewportHeight = window.innerHeight;
        const viewportCenter = window.scrollY + (viewportHeight / 2);
        const timelineItems = document.querySelectorAll('.timeline__item');
        let newActiveYear = null;
        let newActiveDecade = null;
        let activeItem = null;

        // Find which item is at the center of viewport
        for (let i = 0; i < timelineItems.length; i++) {
            const item = timelineItems[i];
            const itemTop = item.offsetTop;
            const itemBottom = itemTop + item.offsetHeight;
            const itemCenter = itemTop + (item.offsetHeight / 2);

            // Check if item center is near viewport center
            if (Math.abs(itemCenter - viewportCenter) < 100) {
                newActiveYear = item.getAttribute('data-year');
                newActiveDecade = item.getAttribute('data-decade');
                activeItem = item;
                break;
            }
        }

        // If no item at center, find the closest one
        if (!newActiveYear && timelineItems.length > 0) {
            let closestItem = timelineItems[0];
            let closestDistance = Math.abs(timelineItems[0].offsetTop + (timelineItems[0].offsetHeight / 2) - viewportCenter);

            timelineItems.forEach(item => {
                const itemCenter = item.offsetTop + (item.offsetHeight / 2);
                const distance = Math.abs(itemCenter - viewportCenter);
                if (distance < closestDistance) {
                    closestDistance = distance;
                    closestItem = item;
                }
            });

            newActiveYear = closestItem.getAttribute('data-year');
            newActiveDecade = closestItem.getAttribute('data-decade');
            activeItem = closestItem;
        }

        // Highlight current card
        // timelineItems.forEach(item => {
        //     item.querySelector('.timeline__content-wrapper').style.transform = '';
        //     item.querySelector('.timeline__content-wrapper').style.opacity = '';
        // });

        // if (activeItem) {
        //     activeItem.querySelector('.timeline__content-wrapper').style.transform = 'scale(1.05)';
        //     activeItem.querySelector('.timeline__content-wrapper').style.opacity = '1';
        // }

        if (newActiveYear !== currentActiveYear) {
            currentActiveYear = newActiveYear;
            
            // Update year indicator
            progressYearValue.textContent = newActiveYear;
        }

        if (newActiveDecade !== currentActiveDecade) {
            currentActiveDecade = newActiveDecade;
            updateActiveDecadeButton(newActiveDecade);
            centerActiveDecadeInNav(newActiveDecade);
        }
    }

    // Update active decade button styling
    function updateActiveDecadeButton(activeDecade) {
        const decadeNavButtons = document.querySelectorAll('button.year-nav__button');

        decadeNavButtons.forEach(button => {
            const buttonDecade = button.getAttribute('data-decade');
            if (buttonDecade == activeDecade) {
                button.classList.add('year-nav__button--active');
            } else {
                button.classList.remove('year-nav__button--active');
            }
        });
    }

    // Center active decade in navigation when possible
    function centerActiveDecadeInNav(activeDecade) {
        const activeButton = document.querySelector(`[data-decade="${activeDecade}"]`);
        if (!activeButton) return;

        const buttonRect = activeButton.getBoundingClientRect();
        const containerRect = yearNavScroll.getBoundingClientRect();
        const buttonCenter = activeButton.offsetLeft + (activeButton.offsetWidth / 2);
        const containerCenter = yearNavScroll.clientWidth / 2;

        const targetScrollPosition = Math.max(0, buttonCenter - containerCenter);
        const maxScroll = Math.max(0, yearButtons.scrollWidth - yearNavScroll.clientWidth);

        yearNavScrollPosition = Math.min(maxScroll, targetScrollPosition);
        updateYearNavScroll();
    }

    // Animate timeline items into view
    function animateTimelineItems() {
        // Disconnect existing observer if it exists
        if (activeYearObserver) {
            activeYearObserver.disconnect();
        }

        activeYearObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                    activeYearObserver.unobserve(entry.target);
                }
            });
        }, {
            root: null,
            rootMargin: '50px',
            threshold: 0.1
        });

        const timelineItems = document.querySelectorAll('.timeline__item');
        timelineItems.forEach(item => {
            activeYearObserver.observe(item);
        });
    }

    // Handle window resize
    window.addEventListener('resize', () => {
        updateArrowStates();
    });
</script>
    <script src="../js/vendor/splide.min.js"></script>
    <script src="../js/main.min.js"></script>

</body>
</html>